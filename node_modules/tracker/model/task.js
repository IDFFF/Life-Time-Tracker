var mongoose = require('mongoose'),
    Schema = mongoose.Schema,
    ObjectId = Schema.ObjectId;

var Task = Schema({
    name: String,
    attributes: Object,
    children: [{type: ObjectId, ref: "Task"}],
    parent: { type: ObjectId, default: null},
    projectId: ObjectId,
    versionId: ObjectId,
    progress: {type: Number, default: -1},
    createTime: Date,
    lastActiveTime: Date
});


Task.methods.complete = function (cb) {
    this.set('progress', 100);
    this.save(cb);
};

Task.methods.restart = function (cb) {
    this.set('progress', 0);
    this.save(cb);
};

module.exports = mongoose.model('Task', Task);
