/**
 * calendar generator
 *
 * can be see as an entr for all calendar type
 */

'use strict';


//var fileHelper = require('../fileHelper');
var Q = require('q');


var Search = require('./search/search');
var Moment = require('moment');


exports.generate = function (options) {
    var deferred = Q.defer();
    options.group = 'date';
    options.sum = true;
    Search.query(options)
        .then(function (days) {
            var result = days.map(function (day) {
                return {
                    date: new Moment(day._id).toDate(),
                    count: day.totalTime
                };
            });
            deferred.resolve(result);
        }).catch(function (err) {
            deferred.reject(err);
        });
    return deferred.promise;
};